(this["webpackJsonpws-console"]=this["webpackJsonpws-console"]||[]).push([[0],{39:function(e,t,n){e.exports=n(82)},44:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a,r,c=n(0),o=n.n(c),i=n(35),s=n.n(i),l=(n(44),n(16)),u=n(2),m=n(38),d=n(4),f={signIn:"/ws-console/sign-in",main:"/ws-console/"},p=n(1),v=Object(p.e)("set authorization"),b=Object(p.e)("set token"),g=Object(p.e)("set authorization error"),E=Object(p.e)("reset authorization error"),h=Object(p.e)("set authorization loading"),w=Object(p.f)(!1).on(v,(function(e,t){return t})),j=(Object(p.f)("").on(b,(function(e,t){return t})),Object(p.f)("").on(g,(function(e,t){return t})).reset(E)),O=Object(p.f)(!1).on(h,(function(e,t){return t})),_=n(7),k=n.n(_),N=n(10),x=n(17),y=n(20),C=n.n(y),T=n(13),M="_appToken",D="https://github.com/fmva/ws-console",I="https://work.vint-x.net/api",L=function(e){var t=e.username,n=e.password;return C.a.post("".concat(I,"/login"),{username:t,password:n})},S={socket:null},q=function(e,t,n){S.socket=new WebSocket(e),S.socket.onmessage=function(e){t&&t(e.data)},S.socket.onclose=function(){var e=Object(N.a)(k.a.mark((function e(t){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&n(t.code,t.wasClean,t.reason);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S.socket.onerror=function(){S.socket.close()}},F=function(){S.socket&&(clearTimeout(r),S.socket.close())},P=function(){try{T.get(M)&&v(!0)}catch(e){v(!1)}},z=function(){T.remove(M),v(!1)},W=function(e){return!(400===e||401===e)},J=function(){var e=Object(N.a)(k.a.mark((function e(t,n,a){var r,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=0;case 1:if(!(c<a)){e.next=16;break}return e.prev=2,e.next=5,t(n);case 5:return e.abrupt("return",e.sent);case 8:if(e.prev=8,e.t0=e.catch(2),r=e.t0,W(e.t0.response.status)){e.next=13;break}return e.abrupt("break",16);case 13:c++,e.next=1;break;case 16:throw r;case 17:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n,a){return e.apply(this,arguments)}}(),R=function(e){return"0".concat(e).slice(-2)},B=function(e){if(0===e)return"";var t=new Date(1e3*e);return"".concat(R(t.getDate()),"-").concat(R(t.getMonth()+1),"-").concat(t.getFullYear()," ").concat(R(t.getHours()),":").concat(R(t.getMinutes()),":").concat(R(t.getSeconds()))},$=Object(p.d)({handler:function(e){return Object(N.a)(k.a.mark((function t(){var n,a,r,c;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.login,a=e.password,r=e.history,h(!0),t.prev=2,t.next=5,J(L,{password:a,username:n},3);case 5:c=t.sent,o=c.headers["x-test-app-jwt-token"],T.set(M,o,{expires:1}),v(!0),r.push(f.main),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),z(),t.t0&&t.t0.response&&t.t0.response.data&&t.t0.response.data.description&&g(t.t0.response.data.description);case 15:h(!1);case 16:case"end":return t.stop()}var o}),t,null,[[2,11]])})))()}}),H=function(e){var t=e.component,n=Object(m.a)(e,["component"]),a=Object(d.a)(w);return o.a.createElement(u.b,Object.assign({},n,{render:function(e){return!0===a?o.a.createElement(t,e):o.a.createElement(u.a,{to:f.signIn})}}))},U=n(11),Y=n(15),A=(n(68),function(e){var t=e.title;return o.a.createElement("h1",{className:"main__title"},t)}),G=(n(69),function(e){var t=e.component,n=e.title;return o.a.createElement("section",{className:"info-card"},""!==n&&o.a.createElement("div",{className:"info-card__title"},o.a.createElement(A,{title:n})),o.a.createElement("div",{className:"info-card__body"},t))});G.defaultProps={title:""};var K=n(5),Q=n.n(K),V=(n(70),o.a.memo((function(e){var t=e.title,n=e.value,a=e.onChange,r=e.type,c=e.disabled,i=e.maxLength,s=e.errorMessage;return o.a.createElement("div",{className:"custom-input"},o.a.createElement("div",{className:"custom-input__title ".concat(""!==s?"custom-input__title-error":"")},t),o.a.createElement("input",{className:"custom-input__input ".concat(""!==s?"custom-input__input-error":""),type:r,value:n,onChange:a,maxLength:i,disabled:c}),""!==s&&o.a.createElement("div",{className:"custom-input__error"},s))})));V.defaultProps={title:"",type:"text",maxLength:null,errorMessage:"",disabled:!1},V.propTypes={value:Q.a.string.isRequired,onChange:Q.a.func.isRequired,type:Q.a.oneOf(["text","password","number"]),maxLength:Q.a.number,title:Q.a.string,errorMessage:Q.a.string,disabled:Q.a.bool};n(71);var X=function(){return o.a.createElement("div",{className:"lds-spinner"},o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null))},Z=(n(72),function(e){var t=e.title,n=e.type,a=e.loading,r=e.onClick;return o.a.createElement("button",{className:"custom-button",type:n,onClick:r},a?o.a.createElement(X,null):t)});Z.defaultProps={type:"submit",onClick:null,loading:!1};n(73);var ee=function(e){var t=e.message;return o.a.createElement(o.a.Fragment,null,""!==t?o.a.createElement("div",{className:"login-error-message"},t):null)};ee.defaultProps={message:""};var te,ne={login:"Username",password:"Password",signIn:"Login",title:"WS Time",required:"Required",connected:"Connected",disconnected:"Disconnected",logout:"Logout",gitTitle:"@fmva"},ae=function(e){return void 0!==ne[e]?ne[e]:"$".concat(e,"$")},re=(n(74),function(e,t){t(e.currentTarget.value)}),ce={login:"",password:""},oe=function(){var e=Object(d.a)(w),t=Object(d.a)(j),n=Object(d.a)(O),a=Object(u.g)(),r=Object(c.useState)(""),i=Object(U.a)(r,2),s=i[0],l=i[1],m=Object(c.useState)(""),p=Object(U.a)(m,2),v=p[0],b=p[1],g=Object(c.useState)(Object(Y.a)({},ce)),h=Object(U.a)(g,2),_=h[0],k=h[1];Object(c.useEffect)((function(){e&&a.push(f.main)}),[e,a]);var N=o.a.createElement("div",null,o.a.createElement("form",{className:"sign-in__form",onSubmit:function(e){e.preventDefault(),E();var t=s.trim(),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Object(Y.a)({},ce);return n.login=""===e?ae("required"):"",n.password=""===t?ae("required"):"",n}(t,v);k(n),Object.keys(n).some((function(e){return""!==n[e]}))||$({password:v,history:a,login:t})}},o.a.createElement(ee,{message:t}),o.a.createElement("div",{className:"sign-in__row"},o.a.createElement(V,{title:ae("login"),value:s,onChange:function(e){re(e,l)},errorMessage:_.login,disabled:n})),o.a.createElement("div",{className:"sign-in__row"},o.a.createElement(V,{title:ae("password"),value:v,type:"password",onChange:function(e){re(e,b)},errorMessage:_.password,disabled:n})),o.a.createElement("div",{className:"sign-in__row"},o.a.createElement(Z,{title:ae("signIn"),loading:n}))));return o.a.createElement("main",{className:"sign-in"},o.a.createElement("div",{className:"sign-in__card"},o.a.createElement(G,{title:ae("title"),component:N})))},ie=(n(75),function(e){var t=e.title,n=e.link;return o.a.createElement("a",{className:"custom-link",href:n,target:"_blank",rel:"noopener noreferrer"},t)}),se=function(){return o.a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M1 1L19 19",stroke:"#0D0D0D",strokeWidth:"2",strokeLinecap:"round"}),o.a.createElement("path",{d:"M19 1L1 19",stroke:"#0D0D0D",strokeWidth:"2",strokeLinecap:"round"}))},le=(n(76),function(e){var t=e.title,n=e.message,a=e.onClick;return o.a.createElement("section",{className:"notification-window"},o.a.createElement("div",{className:"notification-window__header"},o.a.createElement("div",{className:"notification-window__title"},t),o.a.createElement("div",{className:"notification-window__close"},o.a.createElement("button",{type:"button",onClick:a},o.a.createElement(se,null)))),o.a.createElement("div",{className:"notification-window__message"},n))}),ue=n(9),me=Object(p.e)("add notification item to the pipe"),de=Object(p.e)("remove notification item from the pipe"),fe=Object(p.e)("shift message from notification pipe"),pe=Object(p.f)([]).on(me,(function(e,t){return[].concat(Object(ue.a)(e),[Object(Y.a)({},t,{id:"_".concat(Math.random().toString(36).substr(2,9))})])})).on(fe,(function(e){var t=Object(ue.a)(e);return t.shift(),t})).on(de,(function(e,t){return e.filter((function(e){return e.id!==t}))})),ve=function(e,t){if(t&&t.response&&t.response.status&&!W(t.response.status))z();else{var n="";void 0!==t&&void 0!==t.response&&void 0!==t.response.data?n="".concat(t.response.status?t.response.status:""," ").concat(t.response.data.description):void 0!==t.message&&void 0!==t.name&&(n="".concat(t.name," ").concat(t.message)),me({title:e,message:n})}},be=(n(77),function(){var e=Object(d.a)(pe);Object(c.useEffect)((function(){return function(){clearInterval(te)}}),[]),Object(c.useEffect)((function(){0!==e.length?(clearInterval(te),te=setInterval((function(){fe()}),1e4)):clearInterval(te)}),[e,e.length]);var t=e.map((function(e){return o.a.createElement("li",{key:e.id,className:"notification-container__item"},o.a.createElement(le,{title:e.title,onClick:(t=e.id,function(){de(t)}),message:e.message}));var t}));return o.a.createElement(o.a.Fragment,null,e.length>0?o.a.createElement("ul",{className:"notification-container"},t):null)}),ge=(n(78),function(e){var t=e.status,n=e.connectedTitle,a=e.disconnectedTitle;return o.a.createElement("div",{className:"connection-status ".concat(t?"connection-status_connected":"connection-status_disconnected")},t?n:a)}),Ee=Object(p.e)("set connected status"),he=Object(p.e)("set disconnected status"),we=Object(p.e)("set server time"),je=Object(p.e)("reset server time"),Oe=Object(p.d)({handler:function(){return Object(N.a)(k.a.mark((function e(){var t,n,c,o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){he()},n=function(){Oe()},c=function(e){var c,o;we(JSON.parse(e).server_time),Ee(),c=t,o=n,clearTimeout(a),a=setTimeout(c,3e3),clearTimeout(r),r=setTimeout((function(){F(),o()}),1e4)},e.prev=3,e.next=6,C.a.get("".concat(I,"/subscribe"),{headers:Object(x.a)({},"x-test-app-jwt-token",T.get(M))});case 6:o=e.sent,q(o.data.url,c),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),F.close(),ve("subscribeFx",e.t0);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))()}}),_e=Object(p.f)(!1).on(Ee,(function(){return!0})).reset(he),ke=Object(p.f)(0).on(we,(function(e,t){return t})).reset(je),Ne=function(){var e=Object(d.a)(_e);return o.a.createElement(ge,{status:e,connectedTitle:ae("connected"),disconnectedTitle:ae("disconnected")})},xe=(n(79),function(e){var t=e.time,n=e.isConnection;return o.a.createElement(o.a.Fragment,null,""!==t?o.a.createElement("div",{className:"server-time ".concat(n?"":"server-time_disconnected")},t):null)}),ye=function(){var e=Object(d.a)(_e),t=Object(d.a)(ke);return o.a.createElement(xe,{time:B(t),isConnection:e})},Ce=(n(80),function(){Object(c.useEffect)((function(){Oe()}),[]);var e=o.a.createElement("div",null,o.a.createElement("div",{className:"main__row"},o.a.createElement(Ne,null)),o.a.createElement("div",{className:"main__row"},o.a.createElement(ye,null)),o.a.createElement("div",{className:"main__row"},o.a.createElement(Z,{type:"button",title:ae("logout"),onClick:function(){F(),z()}})));return o.a.createElement("main",{className:"main"},o.a.createElement("div",{className:"main__card"},o.a.createElement(G,{title:ae("title"),component:e}),o.a.createElement("div",{className:"main__git-row"},o.a.createElement(ie,{title:ae("gitTitle"),link:D}))),o.a.createElement(be,null))}),Te=(n(81),function(){return P(),o.a.createElement(l.a,null,o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:f.signIn,component:oe}),o.a.createElement(H,{path:[f.main,"/"],component:Ce})))});s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Te,null)),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.dd604bc8.chunk.js.map